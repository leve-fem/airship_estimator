# airship_estimator

This package was developed for the [NOAMAY](https://revistapesquisa.fapesp.br/2018/05/23/dirigivel-sobre-a-floresta/) airship from project DRONI. 

The package contains algorithms for estimation of pose and velocity of the airship. Also, it include algorithms for estimation of the wind incident in the airship body. 


## First steps
It is a pre-requisite the [ROS](http://wiki.ros.org/ROS/Installation) version melodic and the [Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page) librarie.

1. Clone this project;

2. Install [robot_localization](https://wiki.ros.org/robot_localization);

3. Install [rqt_multiplot](http://wiki.ros.org/rqt_multiplot);

4. Download the files [data_set.bag](https://www.dropbox.com/s/abjkcnbxy7qy39h/data_set.bag?dl=0), [wind_estimator_validating_test_1.bag](https://www.dropbox.com/s/di1g82vibn2ey2z/wind_validating_test_1.bag?dl=0) and [wind_estimator_validating_test_2.bag](https://www.dropbox.com/s/9c1pbca60b6l6s6/wind_validating_test_2.bag?dl=0). Save them inside the project in a folder named ```bag_files/```;

5. Compile all the project;

6. Running command below you can test if the installation was successfully completed.
```
roslaunch airship_estimator play_data_set.launch
```

## Pose Estimation

The algorithms available are: Extended Kalman Filter (EKF), Unscented Kalman Filter (UKF) and Low-pass Filter (LPF).

### Visual results

[LPF](https://youtu.be/VL5dvCyOZwY)
[EKF](https://youtu.be/jaATwV0rG30)
[UKF](https://youtu.be/B26xaKtAyWo)

### How to use

You can configure UKF and EKF parameters by editing the file:
```
config/ukf_params.yaml
```
You can configure LPF parameters by editing the file:
```
launch/lpf.launch
```
You can configure Acceleration correction parameters by editing the file:
```
config/accel_estimator_params.yaml
```

In files ```launch/play_data_set.launch``` and ```launch/play_results.launch``` you can comment/uncomment some lines to change between EKF/UKF/LPF filters as you want.

Before running ```launch/play_results.launch``` you will have to change the name of the bag file inside the launch with the one generated by ```launch/play_data_set.launch```.

## Wind Estimators

This package presents four alternative versions for estimation of wind velocity, namely: two Extended Kalman Filter approaches (or model-based approaches); a Neural Network (or data-driven approach); and a hybrid estimator which performs a fusion between the model-based and data-driven estimators. The training dataset used for the Neural Network can be found [here](https://www.dropbox.com/s/97kk4n6inde94c3/wind_estimator_training_dataset.mat?dl=0).

Running command below you can test with the estimators are well installed:
```
roslaunch airship_estimator test_wind_estimators.launch
```

The model-based wind estimators (Extended Kalman Filters) are impelemented in C++ as a ROS node in files ```src/wind_estimator_cho2011.cpp```, ```src/wind_estimator.cpp``` and ```src/wind_estimator_simple.cpp```.

The Neural Network is implemented in Python as a ROS node in file ```src/wind_estimator_nn.py```.

The Hybrid estimator is implemented in C++ as a ROS node in file ```src/wind_estimator_hybrid.cpp```.

Each node has a configuration file in the folder ```config/``` in which the user can set the covariance matrices, topic names and other parameters.

## Other Resources
Further details can be found in the papers below: 

[Comparative study for Robotic Airship State estimation with LPF, EKF and UKF](https://proceedings.science/sbai-2019/papers/comparative-study-for-robotic-airship-state-estimation-with-lpf--ekf-and-ukf)

[Hybrid Model-Based and Data-Driven Wind Velocity Estimator for the Navigation System of a Robotic Airship](https://link.springer.com/article/10.1007/s40430-020-2215-8)

## How to cite
If you find this code useful in your research, please consider citing:

    @inproceedings{Marton2019,
      doi = {10.17648/sbai-2019-111114},
      url = {https://doi.org/10.17648/sbai-2019-111114},
      year = {2019},
      publisher = {Galoa},
      author = {Apolo Silva Marton and Lucas A.C.O. Nogueira and Andre Ricardo Fioravanti and Ely C. de Paiva},
      title = {Comparative study for Robotic Airship State estimation with {LPF},  {EKF} and {UKF}},
      booktitle = {Anais do 14{\textordmasculine} Simp{\'{o}}sio Brasileiro de Automa{\c{c}}{\~{a}}o Inteligente}
    }
    
    @article{Marton2020,
      doi = {10.1007/s40430-020-2215-8},
      url = {https://doi.org/10.1007/s40430-020-2215-8},
      year = {2020},
      month = feb,
      publisher = {Springer Science and Business Media {LLC}},
      volume = {42},
      number = {3},
      author = {Apolo Silva Marton and Andr{\'{e}} Ricardo Fioravanti and Jos{\'{e}} Raul Azinheira and Ely Carneiro de Paiva},
      title = {Hybrid model-based and data-driven wind velocity estimator for an autonomous robotic airship},
      journal = {Journal of the Brazilian Society of Mechanical Sciences and Engineering}
    }
  
